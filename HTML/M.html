<%@ page pageEncoding="UTF-8"%>

<h1>Problem M: Dial</h1>

<h2>Problem</h2>
<p>
ダイヤル式の南京錠がある。<br>
この南京錠には、5つのダイヤルと、決定ボタンが用意されてある。<br><br>
</p>
<p>
5つあるダイヤルを回転させて、16進数で5ケタの整数を入力し決定ボタンを押すと、入力した値とパスワードが一致していれば開く仕組みになっている。<br>

5つのダイヤルそれぞれには<br>
 0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f,0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f,0,1,2, ...<br>
の順で文字がかかれてある。
</p>

<p>
持ち主はパスワードを忘れてしまった。<br><br>

しかし、パスワードの5ケタのうち、1つのケタだけが偶数で残り4つは奇数であったことは覚えている。<br>
ただし、偶数とは0,2,4,6,8,a,c,eであり、奇数とは1,3,5,7,9,b,d,fである。<br><br>

また、この鍵は不良品で、パスワードと異なる数字を入力していても場合によっては開いてしまうことが分かっている。<br><br>
本来、入力した整数とパスワードが5つのケタすべてについて一致していなければ鍵は開かない。<br>
しかし、パスワードの<var>i</var>ケタ目が偶数だった場合、<var>i</var>ケタ目にその偶数の前後にある奇数を入力すると、<var>i</var>ケタ目は一致していると誤判定されてしまうのだ。なお、0 の前後には1とfの奇数がある。<br><br>

例えば、パスワードが'57677'の南京錠ならば<br>
'57677'のほかに、'57577'や'57777'を入力したときでも開いてしまう。<br><br>

同様に、パスワードが'130bd'の南京錠ならば<br>
'130bd'のほかに、'13fbd'や'131bd'を入力したときでも開いてしまう。
</p>

<p>
今、パスワードの候補が<var>N</var>つあり、それらのうちどれか1つが正解のパスワードであることが分かっている。<br><br>

しかたがないので持ち主は、鍵が開くまで何度も整数を入力して試し続けることにした。<br>
持ち主はできるだけ整数を入力する回数を少なくしたい。<br>

持ち主が最適な戦略をとったとき、最大で何回整数を入力しなければならないだろうか?<br>
その回数を出力せよ。<br>
また、実際に最大となるときに入力する整数の集合を昇順に出力せよ。<br>
答えが一意に定まらない場合は、辞書順で最小となるものを出力せよ。
</p>

<h2>Input</h2>
<p>入力は以下の形式で与えられる。</p>
<pre>
  <var>N</var>
  <var>password<sub>1</sub></var>
  <var>password<sub>2</sub></var>
  ...
  <var>password<sub>N</sub></var>
</pre>
<p>
1行目に<var>N</var>が与えられる。<br>
2行目から<var>N</var>-1行目の<var>i</var>行目には、パスワードの候補を表す文字列<var>password<sub>i</sub></var>が与えられる。
</p>

<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
  <li>1 &le; <var>N</var> &le; 1000</li>
  <li>文字列は、0~9の数字または英小文字a~fの5文字で構成され、そのうち1文字は偶数であり、他の4文字は奇数である。</li>
</ul>

<h2>Output</h2>
<p>
  鍵が開くまでに最適な戦略をとったときの整数の入力回数の最大値を1行に出力する。<br>
  続いて、最大となるときに入力する整数の集合を昇順に出力する。<br>
  もし、答えが一意に定まらない場合は、辞書順で最小となるものを出力する。
</p>

<h2>Sample Input 1</h2>
<pre>
1
0111f
</pre>

<h2>Sample Output 1</h2>
<pre>
0111f
</pre>

<h2>Sample Input 2</h2>
<pre>
3
57567
57587
0d351
</pre>

<h2>Sample Output 2</h2>
<pre>
2
0d351
57577
</pre>

<h2>Sample Input 3</h2>
<pre>
6
1811b
1a11b
f3b1e
f3b1c
b0df3
bedf3
</pre>

<h2>Sample Output 3</h2>
<pre>
3
1911b
bfdf3
f3b1d
</pre>
